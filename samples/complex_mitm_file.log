2024-03-15 10:23:45.123 [INFO] mitmproxy v8.1.1 started
2024-03-15 10:23:45.124 [INFO] Proxy server listening at *:8080
2024-03-15 10:23:45.125 [INFO] Web interface listening at http://127.0.0.1:8081/

2024-03-15 10:24:12.456 127.0.0.1:52341 -> api.example.com:443 [CONNECT]
2024-03-15 10:24:12.467 ESTABLISHED SSL tunnel to api.example.com:443

2024-03-15 10:24:12.478 [REQUEST] GET https://api.example.com/v1/users/123
Host: api.example.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.9
Accept-Encoding: gzip, deflate, br
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjMiLCJuYW1lIjoiSm9obiBEb2UiLCJpYXQiOjE1MTYyMzkwMjJ9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
X-API-Key: sk_live_51Hn8ZFGKyGz9Vx12345
X-Request-ID: req_1a2b3c4d5e6f
Connection: keep-alive
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin

2024-03-15 10:24:12.523 [RESPONSE] 200 OK
Content-Type: application/json; charset=utf-8
Content-Length: 342
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 999
X-RateLimit-Reset: 1710501852
X-Response-Time: 45ms
Cache-Control: no-cache, no-store, must-revalidate
Server: nginx/1.18.0
Date: Fri, 15 Mar 2024 10:24:12 GMT
Connection: keep-alive

{"id":123,"username":"johndoe","email":"john@example.com","profile":{"firstName":"John","lastName":"Doe","avatar":"https://cdn.example.com/avatars/123.jpg"},"created_at":"2023-01-15T10:30:00Z","last_login":"2024-03-15T09:15:22Z","permissions":["read","write","admin"]}

2024-03-15 10:24:15.789 [REQUEST] POST https://api.example.com/v2/orders
Host: api.example.com
User-Agent: PostmanRuntime/7.36.1
Accept: */*
Content-Type: application/json
Content-Length: 258
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0NTYiLCJyb2xlIjoiY3VzdG9tZXIiLCJpYXQiOjE3MTA0OTg2NTJ9.abc123def456ghi789
X-API-Version: 2.1
X-Client-Version: mobile-app-v3.2.1
X-Device-ID: device_abc123def456
Idempotency-Key: idmp_1710498655_order_create

{"customer_id":456,"items":[{"product_id":"prod_123","quantity":2,"price":29.99},{"product_id":"prod_456","quantity":1,"price":149.99}],"shipping_address":{"street":"123 Main St","city":"Anytown","state":"CA","zip":"90210"},"payment_method":"card_1234567890"}

2024-03-15 10:24:15.845 [RESPONSE] 201 Created
Content-Type: application/json
Location: https://api.example.com/v2/orders/ord_789abc123
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 87
X-RateLimit-Reset: 1710499200
X-Response-Time: 56ms
Server: nginx/1.18.0
Date: Fri, 15 Mar 2024 10:24:15 GMT

{"order_id":"ord_789abc123","status":"pending","total_amount":209.97,"estimated_delivery":"2024-03-20","tracking_number":null,"created_at":"2024-03-15T10:24:15.845Z"}

2024-03-15 10:24:18.234 192.168.1.105:45632 -> payments.stripe.com:443 [CONNECT]
2024-03-15 10:24:18.245 ESTABLISHED SSL tunnel to payments.stripe.com:443

2024-03-15 10:24:18.256 [REQUEST] POST https://payments.stripe.com/v1/payment_intents
Host: payments.stripe.com
User-Agent: Stripe/v1 NodeBindings/8.222.0
Accept: application/json
Content-Type: application/x-www-form-urlencoded
Content-Length: 287
Authorization: Bearer sk_live_51HnLTGKyGz9VxNhL8Hn3Dm3z1QY4X5
Stripe-Version: 2020-08-27
X-Stripe-Client-User-Agent: {"bindings_version":"8.222.0","lang":"node","lang_version":"18.17.0","platform":"linux","publisher":"stripe","uname":"Linux version 5.4.0-89-generic"}

amount=20997&currency=usd&payment_method=pm_1ABC23def456GHI&customer=cus_ABC123def456&description=Order+ord_789abc123&metadata[order_id]=ord_789abc123&metadata[customer_id]=456&confirm=true&return_url=https://example.com/payment/return

2024-03-15 10:24:18.312 [RESPONSE] 200 OK
Content-Type: application/json
Request-Id: req_123abc456def789
Stripe-Version: 2020-08-27
X-Stripe-C-Cost: 73
Cache-Control: no-cache, no-store

{"id":"pi_3ABC123def456GHI789","object":"payment_intent","amount":20997,"currency":"usd","status":"succeeded","client_secret":"pi_3ABC123def456GHI789_secret_xyz","created":1710498658,"customer":"cus_ABC123def456"}

2024-03-15 10:24:22.567 [REQUEST] PATCH https://api.example.com/v1/users/123/profile
Host: api.example.com
User-Agent: MyApp/2.1.0 (iOS 17.0; iPhone14,2)
Accept: application/json
Content-Type: application/json
Content-Length: 89
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjMiLCJuYW1lIjoiSm9obiBEb2UiLCJpYXQiOjE1MTYyMzkwMjJ9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
X-API-Key: sk_live_51Hn8ZFGKyGz9Vx12345
If-Match: "33a64df551425fcc55e4d42a148795d9f25f89d4"

{"profile":{"firstName":"John","lastName":"Smith","phone":"+1-555-0123","bio":"Software Engineer"}}

2024-03-15 10:24:22.601 [RESPONSE] 200 OK
Content-Type: application/json
ETag: "686897696a7c876b7e"
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 998
Last-Modified: Fri, 15 Mar 2024 10:24:22 GMT

{"id":123,"username":"johndoe","email":"john@example.com","profile":{"firstName":"John","lastName":"Smith","phone":"+1-555-0123","bio":"Software Engineer","avatar":"https://cdn.example.com/avatars/123.jpg"},"updated_at":"2024-03-15T10:24:22.601Z"}

2024-03-15 10:24:25.123 [REQUEST] GET https://api.example.com/v1/products?category=electronics&page=2&limit=20&sort=price_asc
Host: api.example.com
User-Agent: curl/7.81.0
Accept: */*
X-API-Key: sk_live_public_abc123def456
X-Client-IP: 203.0.113.42
X-Forwarded-For: 203.0.113.42, 198.51.100.17
Accept-Encoding: gzip

2024-03-15 10:24:25.178 [RESPONSE] 200 OK
Content-Type: application/json
X-Total-Count: 487
X-Page: 2
X-Per-Page: 20
Link: <https://api.example.com/v1/products?category=electronics&page=1&limit=20&sort=price_asc>; rel="prev", <https://api.example.com/v1/products?category=electronics&page=3&limit=20&sort=price_asc>; rel="next"
X-RateLimit-Limit: 5000
X-RateLimit-Remaining: 4987
Content-Encoding: gzip
Vary: Accept-Encoding

{"products":[{"id":"prod_789","name":"Wireless Headphones","price":79.99,"category":"electronics","in_stock":true},{"id":"prod_790","name":"Bluetooth Speaker","price":89.99,"category":"electronics","in_stock":false}],"pagination":{"page":2,"per_page":20,"total":487,"total_pages":25}}

2024-03-15 10:24:28.445 [REQUEST] DELETE https://api.example.com/v1/sessions/sess_abc123def456
Host: api.example.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.1.15
Accept: */*
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZXNzaW9uIjoic2Vzc19hYmMxMjNkZWY0NTYiLCJpYXQiOjE3MTA0OTg2Njh9.xyz789abc123def
X-CSRF-Token: csrf_token_example_123456789
Referer: https://example.com/logout

2024-03-15 10:24:28.467 [RESPONSE] 204 No Content
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 997
Set-Cookie: session=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT; HttpOnly; Secure
Cache-Control: no-cache

2024-03-15 10:24:31.789 [REQUEST] PUT https://api.example.com/v3/files/file_123abc/metadata
Host: api.example.com
User-Agent: FileManager/1.0 (Windows NT 10.0; Win64; x64)
Accept: application/json
Content-Type: application/json
Content-Length: 156
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI3ODkiLCJzY29wZSI6ImZpbGVzOndyaXRlIiwiaWF0IjoxNzEwNDk4NjcxfQ.signature_here
X-Upload-ID: upload_456def789abc

{"filename":"document.pdf","description":"Q1 Financial Report","tags":["finance","q1","2024"],"public":false,"expires_at":"2024-12-31T23:59:59Z"}

2024-03-15 10:24:31.823 [RESPONSE] 200 OK
Content-Type: application/json
X-File-Version: 2
X-Storage-Used: 1024000
X-Storage-Limit: 10737418240

{"file_id":"file_123abc","filename":"document.pdf","size":1024000,"content_type":"application/pdf","created_at":"2024-03-10T14:30:00Z","updated_at":"2024-03-15T10:24:31.823Z","metadata":{"description":"Q1 Financial Report","tags":["finance","q1","2024"],"public":false,"expires_at":"2024-12-31T23:59:59Z"}}

2024-03-15 10:24:35.234 [ERROR] Connection reset by peer: api.example.com:443

2024-03-15 10:24:35.235 127.0.0.1:52341 -> api.example.com:443 [RECONNECT]

2024-03-15 10:24:35.267 [REQUEST] GET https://api.example.com/v1/notifications?unread=true&limit=50
Host: api.example.com
User-Agent: NotificationService/2.0
Accept: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjMiLCJzZXJ2aWNlIjoibm90aWZpY2F0aW9ucyIsImlhdCI6MTcxMDQ5ODY3NX0.token_signature
X-API-Key: sk_live_51Hn8ZFGKyGz9Vx12345
X-Poll-Interval: 30
If-None-Match: "a1b2c3d4e5f6"

2024-03-15 10:24:35.289 [RESPONSE] 304 Not Modified
ETag: "a1b2c3d4e5f6"
X-Poll-Interval: 30
Cache-Control: max-age=30
X-RateLimit-Limit: 2000
X-RateLimit-Remaining: 1995

2024-03-15 10:24:38.567 [REQUEST] POST https://webhooks.example.com/api/v1/stripe/webhook
Host: webhooks.example.com
User-Agent: Stripe/1.0 (+https://stripe.com/docs/webhooks)
Accept: application/json
Content-Type: application/json
Content-Length: 1247
Stripe-Signature: t=1710498678,v1=abc123def456ghi789jkl012mno345pqr678stu901vwx234yz
X-Forwarded-For: 54.187.216.72
X-Forwarded-Proto: https

{"id":"evt_1ABC123def456GHI789","object":"event","api_version":"2020-08-27","created":1710498678,"data":{"object":{"id":"pi_3ABC123def456GHI789","object":"payment_intent","amount":20997,"amount_capturable":0,"amount_details":{"tip":{}},"amount_received":20997,"application":null,"application_fee_amount":null,"automatic_payment_methods":null,"canceled_at":null,"cancellation_reason":null,"capture_method":"automatic","charges":{"object":"list","data":[{"id":"ch_3ABC123def456GHI789","object":"charge","amount":20997,"amount_captured":20997,"amount_refunded":0,"application":null,"application_fee":null,"application_fee_amount":null,"balance_transaction":"txn_3ABC123def456GHI789","billing_details":{"address":{"city":null,"country":"US","line1":null,"line2":null,"postal_code":"90210","state":"CA"},"email":"customer@example.com","name":"John Doe","phone":null},"calculated_statement_descriptor":"EXAMPLE.COM","captured":true,"created":1710498678,"currency":"usd","customer":"cus_ABC123def456","description":"Order ord_789abc123","destination":null,"dispute":null,"disputed":false,"failure_balance_transaction":null,"failure_code":null,"failure_message":null,"fraud_details":{},"invoice":null,"livemode":false,"metadata":{"order_id":"ord_789abc123","customer_id":"456"},"on_behalf_of":null,"outcome":{"network_status":"approved_by_network","reason":null,"risk_level":"normal","risk_score":34,"seller_message":"Payment complete.","type":"authorized"},"paid":true,"payment_intent":"pi_3ABC123def456GHI789","payment_method":"pm_1ABC23def456GHI","payment_method_details":{"card":{"brand":"visa","checks":{"address_line1_check":"pass","address_postal_code_check":"pass","cvc_check":"pass"},"country":"US","exp_month":12,"exp_year":2028,"fingerprint":"abc123def456ghi","funding":"credit","installments":null,"last4":"4242","mandate":null,"network":"visa","three_d_secure":null,"wallet":null}},"receipt_email":"customer@example.com","receipt_number":"1710-4986","receipt_url":"https://pay.stripe.com/receipts/payment/abc123def456","refunded":false,"refunds":{"object":"list","data":[],"has_more":false,"total_count":0,"url":"/v1/charges/ch_3ABC123def456GHI789/refunds"},"review":null,"shipping":null,"source_transfer":null,"statement_descriptor":"Example Store","statement_descriptor_suffix":null,"status":"succeeded","transfer_data":null,"transfer_group":null}],"has_more":false,"total_count":1,"url":"/v1/charges?payment_intent=pi_3ABC123def456GHI789"},"client_secret":"pi_3ABC123def456GHI789_secret_xyz","confirmation_method":"automatic","created":1710498658,"currency":"usd","customer":"cus_ABC123def456","description":"Order ord_789abc123","invoice":null,"last_payment_error":null,"latest_charge":"ch_3ABC123def456GHI789","livemode":false,"metadata":{"order_id":"ord_789abc123","customer_id":"456"},"next_action":null,"on_behalf_of":null,"payment_method":"pm_1ABC23def456GHI","payment_method_options":{"card":{"installments":null,"mandate_options":null,"network":null,"request_three_d_secure":"automatic"}},"payment_method_types":["card"],"processing":null,"receipt_email":"customer@example.com","review":null,"setup_future_usage":null,"shipping":null,"source":null,"statement_descriptor":"Example Store","statement_descriptor_suffix":null,"status":"succeeded","transfer_data":null,"transfer_group":null}},"livemode":false,"pending_webhooks":1,"request":{"id":"req_ABC123def456GHI","idempotency_key":"idmp_1710498655_order_create"},"type":"payment_intent.succeeded"}

2024-03-15 10:24:38.612 [RESPONSE] 200 OK
Content-Type: application/json
X-Webhook-ID: wh_abc123def456
X-Processed-At: 2024-03-15T10:24:38.612Z

{"received":true,"processed":true,"webhook_id":"wh_abc123def456"}

2024-03-15 10:24:42.123 [REQUEST] GET https://api.example.com/health/status
Host: api.example.com
User-Agent: UptimeRobot/2.0
Accept: */*
X-Monitor-ID: 787654321

2024-03-15 10:24:42.134 [RESPONSE] 200 OK
Content-Type: application/json
X-Response-Time: 11ms
Cache-Control: no-cache

{"status":"healthy","timestamp":"2024-03-15T10:24:42.134Z","version":"v2.1.3","database":{"status":"connected","latency_ms":2},"cache":{"status":"connected","hit_rate":0.89},"services":{"payment_processor":"operational","notification_service":"operational","file_storage":"operational"}}

2024-03-15 10:24:45.456 [INFO] Total requests processed: 11
2024-03-15 10:24:45.457 [INFO] Average response time: 38ms
2024-03-15 10:24:45.458 [INFO] mitmproxy session ended